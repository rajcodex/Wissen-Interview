<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Three Month Calendar</title>
    <style>
        .holiday {
            background-color: #ffd1d1;
            color: red;
            font-weight: bold;
            border-radius: 5px;
            cursor: pointer;
        }

        .work-holiday {
            background-color: #d1ffd1;
            color: green;
            font-weight: bold;
            border-radius: 5px;
            cursor: pointer;
        }

        .light-green-row td {
            background-color: #e6ffe6 !important;
        }

        .deep-green-row td {
            background-color: #99ff99 !important;
        }

        .date-cell:hover {
            background-color: #f0f0f0;
            cursor: pointer;
            border-radius: 5px;
        }

        table {
            border-collapse: collapse;
            width: 100%;
            text-align: center;
        }

        td, th {
            width: 30px;
            height: 30px;
            padding: 4px;
        }

        #calendarHeader {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
        }

        h2 {
            text-align: center;
            width: 100%;
        }
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 20px;
        }

        .calendar-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .month-box {
            border: 1px solid #ccc;
            border-radius: 10px;
            padding: 10px;
            width: 250px;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.1);
        }

        .month-title {
            font-weight: bold;
            margin-bottom: 10px;
            font-size: 18px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            background-color: #f2f2f2;
            padding: 5px;
        }

        td {
            padding: 5px;
            height: 30px;
            text-align: center;
        }

        td:hover {
            cursor: pointer;
            background-color: #e6f7ff; /* light blue background on hover */
            border-radius: 5px;
        }

        .buttons {
            margin-top: 20px;
        }

        button {
            padding: 10px 15px;
            margin: 0 10px;
            font-size: 16px;
            border-radius: 8px;
            border: 1px solid #aaa;
            cursor: pointer;
        }
    </style>
</head>
<body>

<div style="display: flex; justify-content: space-between; align-items: center;">
    <h1>Vacation Calendar</h1>
    <div>
        <label for="countrySelect">Select Country:</label>
        <select id="countrySelect" onchange="onCountryChange()">
            <option value="">--Select--</option>
            <option value="US">United States</option>
            <option value="IN">India</option>
            <option value="GB">United Kingdom</option>
            <option value="CA">Canada</option>
            <option value="AU">Australia</option>
            <option value="FR">France</option>
            <option value="DE">Germany</option>
            <option value="JP">Japan</option>
            <option value="BR">Brazil</option>
            <option value="ZA">South Africa</option>
        </select>
    </div>
</div>

<div class="calendar-container" id="calendarContainer">
    <!-- Months will be injected here -->
</div>

<div id="calendarHeader">
    <button onclick="prevMonths()">Prev</button>
    <button onclick="nextMonths()">Next</button>
</div>

<div class="buttons" style="margin-top: 30px;">
    <button id="toggleRowsBtn" onclick="toggleNonHolidayRows()">Toggle Hide Non-Holiday Rows</button>
</div>

<script>
    let currentDate = new Date();
    let rowsHidden = false; // toggle flag

    const indiaHolidays = {
        "1-1": "New Year's Day",
        "1-14": "Makar Sankranti",
        "1-26": "Republic Day",
        "2-14": "Vasant Panchami",
        "3-8": "Maha Shivratri",
        "3-25": "Holi",
        "3-29": "Good Friday",
        "4-10": "Ram Navami",
        "4-14": "Ambedkar Jayanti",
        "4-21": "Mahavir Jayanti",
        "5-1": "Labour Day",
        "5-23": "Buddha Purnima",
        "6-17": "Bakrid / Eid al-Adha",
        "7-17": "Muharram",
        "8-15": "Independence Day",
        "8-26": "Janmashtami",
        "9-5": "Teachers' Day",
        "9-17": "Vishwakarma Puja",
        "10-2": "Gandhi Jayanti",
        "10-11": "Maha Ashtami",
        "10-12": "Maha Navami",
        "10-13": "Dussehra",
        "10-31": "Halloween",
        "11-1": "Kannada Rajyotsava",
        "11-2": "All Souls' Day",
        "11-7": "Diwali",
        "11-8": "Govardhan Puja",
        "11-9": "Bhai Dooj",
        "12-24": "Christmas Eve",
        "12-25": "Christmas",
        "12-31": "New Year's Eve"
    };

    // Added several clustered work holidays in March to trigger deep-green row color
    const workHolidays = {
        "1-3": "Company Offsite",
        "2-10": "Quarterly Planning",
        "2-20": "Team Building",
        "3-15": "Internal Training",
        "3-16": "Client Meeting",
        "3-17": "Project Review",
        "3-18": "Hackathon Day",
        "3-19": "Team Outing",
        "4-5": "Strategy Day",
        "4-28": "HR Workshop",
        "5-12": "Innovation Day",
        "6-3": "Volunteer Day",
        "6-22": "Hackathon",
        "7-9": "Product Review",
        "7-30": "Town Hall",
        "8-10": "CSR Event",
        "9-14": "Foundersâ€™ Day",
        "10-5": "Tech Symposium",
        "11-15": "Performance Review",
        "12-2": "Wellness Day"
    };

    function renderCalendar() {
        const container = document.getElementById("calendarContainer");
        container.innerHTML = "";

        let startMonth = currentDate.getMonth();
        let startYear = currentDate.getFullYear();

        for (let i = 0; i < 3; i++) {
            let month = (startMonth + i) % 12;
            let year = startYear + Math.floor((startMonth + i) / 12);
            container.appendChild(createMonthCalendar(year, month));
        }
        // Reset toggle on re-render
        rowsHidden = false;
        document.getElementById("toggleRowsBtn").textContent = "Toggle Hide Non-Holiday Rows";
    }

    function createMonthCalendar(year, monthIndex) {
        const monthNames = ["January", "February", "March", "April", "May", "June",
                            "July", "August", "September", "October", "November", "December"];
        const dayNames = ["S", "M", "T", "W", "T", "F", "S"];

        const monthDiv = document.createElement("div");
        monthDiv.classList.add("month");
        monthDiv.style.display = "inline-block";
        monthDiv.style.margin = "10px";
        monthDiv.style.verticalAlign = "top";

        const header = document.createElement("h3");
        header.textContent = `${monthNames[monthIndex]} ${year}`;
        header.style.textAlign = "center";
        monthDiv.appendChild(header);

        const table = document.createElement("table");

        const thead = document.createElement("thead");
        const trHead = document.createElement("tr");
        for (const day of dayNames) {
            const th = document.createElement("th");
            th.textContent = day;
            trHead.appendChild(th);
        }
        thead.appendChild(trHead);
        table.appendChild(thead);

        const tbody = document.createElement("tbody");
        const firstDay = new Date(year, monthIndex, 1).getDay();
        const daysInMonth = new Date(year, monthIndex + 1, 0).getDate();

        let date = 1;
        for (let i = 0; i < 6; i++) {
            const tr = document.createElement("tr");
            let workHolidayCount = 0;

            for (let j = 0; j < 7; j++) {
                const td = document.createElement("td");
                if (i === 0 && j < firstDay) {
                    td.textContent = "";
                } else if (date > daysInMonth) {
                    td.textContent = "";
                } else {
                    td.textContent = date;
                    const key = `${monthIndex + 1}-${date}`;

                    if (indiaHolidays[key]) {
                        td.classList.add("holiday");
                        td.title = indiaHolidays[key];
                    } else if (workHolidays[key]) {
                        td.classList.add("work-holiday");
                        td.title = workHolidays[key];
                        workHolidayCount++;
                    } else {
                        td.classList.add("date-cell");
                    }
                    date++;
                }
                tr.appendChild(td);
            }

            if (workHolidayCount > 3) {
                tr.classList.add("deep-green-row");
            } else if (workHolidayCount >= 1) {
                tr.classList.add("light-green-row");
            }

            tbody.appendChild(tr);
            if (date > daysInMonth) break;
        }

        table.appendChild(tbody);
        monthDiv.appendChild(table);
        return monthDiv;
    }

    function prevMonths() {
        currentDate.setMonth(currentDate.getMonth() - 3);
        renderCalendar();
    }

    function nextMonths() {
        currentDate.setMonth(currentDate.getMonth() + 3);
        renderCalendar();
    }

    function toggleNonHolidayRows() {
        const container = document.getElementById("calendarContainer");
        const monthDivs = container.querySelectorAll(".month");
        rowsHidden = !rowsHidden;

        monthDivs.forEach(monthDiv => {
            const rows = monthDiv.querySelectorAll("tbody tr");
            rows.forEach(row => {
                const hasHoliday = [...row.cells].some(cell =>
                    cell.classList.contains("holiday") || cell.classList.contains("work-holiday")
                );
                if (!hasHoliday) {
                    row.style.display = rowsHidden ? "none" : "";
                }
            });
        });

        // Update button text
        document.getElementById("toggleRowsBtn").textContent = rowsHidden ? "Show All Rows" : "Toggle Hide Non-Holiday Rows";
    }

    document.addEventListener("DOMContentLoaded", renderCalendar);

    function onCountryChange() {
        renderCalendar();
    }
</script>

</body>
</html>
